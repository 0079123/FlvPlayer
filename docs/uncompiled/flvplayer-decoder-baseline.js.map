{"version":3,"file":"flvplayer-decoder-baseline.js","sources":["../../node_modules/@babel/runtime/helpers/classCallCheck.js","../../node_modules/@babel/runtime/helpers/createClass.js","../../node_modules/@babel/runtime/helpers/typeof.js","../../src/utils/index.js","../../src/decoder/video/baseline/renderer.js","../../src/decoder/video/baseline/index.js"],"sourcesContent":["function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _typeof2(obj) { if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof2 = function _typeof2(obj) { return typeof obj; }; } else { _typeof2 = function _typeof2(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof2(obj); }\n\nfunction _typeof(obj) {\n  if (typeof Symbol === \"function\" && _typeof2(Symbol.iterator) === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return _typeof2(obj);\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : _typeof2(obj);\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","export function hasOwnProperty(obj, name) {\n    return Object.prototype.hasOwnProperty.call(obj, name);\n}\n\nexport function readBuffer(buffer) {\n    let index = 0;\n    function read(length) {\n        const tempUint8 = new Uint8Array(length);\n        for (let i = 0; i < length; i += 1) {\n            tempUint8[i] = buffer[index];\n            index += 1;\n        }\n        read.index = index;\n        return tempUint8;\n    }\n    read.index = 0;\n    return read;\n}\n\nexport function mergeBuffer(...buffers) {\n    const Cons = buffers[0].constructor;\n    return buffers.reduce((pre, val) => {\n        const merge = new Cons((pre.byteLength | 0) + (val.byteLength | 0));\n        merge.set(pre, 0);\n        merge.set(val, pre.byteLength | 0);\n        return merge;\n    }, new Cons());\n}\n\nexport function createWorker(workerString) {\n    return new Worker(URL.createObjectURL(new Blob([workerString], { type: 'application/javascript' })));\n}\n\nexport function secondToTime(second) {\n    const add0 = num => (num < 10 ? `0${num}` : String(num));\n    const hour = Math.floor(second / 3600);\n    const min = Math.floor((second - hour * 3600) / 60);\n    const sec = Math.floor(second - hour * 3600 - min * 60);\n    return (hour > 0 ? [hour, min, sec] : [min, sec]).map(add0).join(':');\n}\n\nexport function getNowTime() {\n    if (performance && typeof performance.now === 'function') {\n        return performance.now();\n    }\n    return Date.now();\n}\n\nexport function debounce(func, wait, context) {\n    let timeout;\n    function fn(...args) {\n        const later = function later() {\n            timeout = null;\n            func.apply(context, args);\n        };\n        clearTimeout(timeout);\n        timeout = setTimeout(later, wait);\n    }\n\n    fn.clearTimeout = function ct() {\n        clearTimeout(timeout);\n    };\n\n    return fn;\n}\n\nexport function throttle(callback, delay) {\n    let isThrottled = false;\n    let args;\n    let context;\n\n    function fn(...args2) {\n        if (isThrottled) {\n            args = args2;\n            context = this;\n            return;\n        }\n\n        isThrottled = true;\n        callback.apply(this, args2);\n        setTimeout(() => {\n            isThrottled = false;\n            if (args) {\n                fn.apply(context, args);\n                args = null;\n                context = null;\n            }\n        }, delay);\n    }\n\n    return fn;\n}\n\nexport function clamp(num, a, b) {\n    return Math.max(Math.min(num, Math.max(a, b)), Math.min(a, b));\n}\n\nexport function setStyle(element, key, value) {\n    if (typeof key === 'object') {\n        Object.keys(key).forEach(item => {\n            setStyle(element, item, key[item]);\n        });\n    }\n    element.style[key] = value;\n    return element;\n}\n\nexport function getStyle(element, key, numberType = true) {\n    const value = getComputedStyle(element, null).getPropertyValue(key);\n    return numberType ? parseFloat(value) : value;\n}\n\nexport function loadScript(url, name) {\n    return new Promise((resolve, reject) => {\n        const $script = document.createElement('script');\n        $script.type = 'text/javascript';\n        $script.onload = () => {\n            if (window[name]) {\n                resolve(window[name]);\n            } else {\n                reject(new Error(`Unable to find global variable '${name}' from '${url}'`));\n            }\n        };\n        $script.onerror = () => {\n            reject(new Error(`Resource loading failed '${url}'`));\n        };\n        $script.src = url;\n        document.head.appendChild($script);\n    });\n}\n\nexport function proxyPropertys(target, ...sources) {\n    sources.forEach(source => {\n        Object.getOwnPropertyNames(source).forEach(key => {\n            if (!hasOwnProperty(target, key)) {\n                Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n            } else {\n                throw new Error(`Target attribute name is duplicated: ${key}`);\n            }\n        });\n    });\n}\n\nexport function calculationRate(callback) {\n    let totalSize = 0;\n    let lastTime = getNowTime();\n    return size => {\n        totalSize += size;\n        const thisTime = getNowTime();\n        const diffTime = thisTime - lastTime;\n        if (diffTime >= 1000) {\n            callback(totalSize / diffTime * 1000);\n            lastTime = thisTime;\n            totalSize = 0;\n        }\n    };\n}\n","//\n//  Copyright (c) 2014 Sam Leitch. All rights reserved.\n//\n//  Permission is hereby granted, free of charge, to any person obtaining a copy\n//  of this software and associated documentation files (the \"Software\"), to\n//  deal in the Software without restriction, including without limitation the\n//  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n//  sell copies of the Software, and to permit persons to whom the Software is\n//  furnished to do so, subject to the following conditions:\n//\n//  The above copyright notice and this permission notice shall be included in\n//  all copies or substantial portions of the Software.\n//\n//  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n//  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n//  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n//  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n//  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\n//  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS\n//  IN THE SOFTWARE.\n//\n\n/**\n * This class can be used to render output pictures from an H264bsdDecoder to a canvas element.\n * If available the content is rendered using WebGL.\n */\nexport default function H264bsdCanvas(canvas, forceNoGL) {\n    this.canvasElement = canvas;\n\n    if(!forceNoGL) this.initContextGL();\n\n    if(this.contextGL) {\n        this.initProgram();\n        this.initBuffers();\n        this.initTextures();\n    }\n}\n\n/**\n * Returns true if the canvas supports WebGL\n */\nH264bsdCanvas.prototype.isWebGL = function() {\n    return this.contextGL;\n}\n\n/**\n * Create the GL context from the canvas element\n */\nH264bsdCanvas.prototype.initContextGL = function() {\n    var canvas = this.canvasElement;\n    var gl = null;\n\n    var validContextNames = [\"webgl\", \"experimental-webgl\", \"moz-webgl\", \"webkit-3d\"];\n    var nameIndex = 0;\n\n    while(!gl && nameIndex < validContextNames.length) {\n        var contextName = validContextNames[nameIndex];\n        \n        try {\n            gl = canvas.getContext(contextName);\n        } catch (e) {\n            gl = null;\n        }\n\n        if(!gl || typeof gl.getParameter !== \"function\") {\n            gl = null;\n        }    \n\n        ++nameIndex;\n    }\n \n    this.contextGL = gl;\n}\n\n/**\n * Initialize GL shader program\n */\nH264bsdCanvas.prototype.initProgram = function() {\n    var gl = this.contextGL;\n\n    var vertexShaderScript = [\n        'attribute vec4 vertexPos;',\n        'attribute vec4 texturePos;',\n        'varying vec2 textureCoord;',\n\n        'void main()',\n        '{',\n            'gl_Position = vertexPos;',\n            'textureCoord = texturePos.xy;',\n        '}'\n        ].join('\\n');\n\n    var fragmentShaderScript = [\n        'precision highp float;',\n        'varying highp vec2 textureCoord;',\n        'uniform sampler2D ySampler;',\n        'uniform sampler2D uSampler;',\n        'uniform sampler2D vSampler;',\n        'const mat4 YUV2RGB = mat4',\n        '(',\n            '1.1643828125, 0, 1.59602734375, -.87078515625,',\n            '1.1643828125, -.39176171875, -.81296875, .52959375,',\n            '1.1643828125, 2.017234375, 0, -1.081390625,',\n            '0, 0, 0, 1',\n        ');',\n      \n        'void main(void) {',\n            'highp float y = texture2D(ySampler,  textureCoord).r;',\n            'highp float u = texture2D(uSampler,  textureCoord).r;',\n            'highp float v = texture2D(vSampler,  textureCoord).r;',\n            'gl_FragColor = vec4(y, u, v, 1) * YUV2RGB;',\n        '}'\n        ].join('\\n');\n\n    var vertexShader = gl.createShader(gl.VERTEX_SHADER);\n    gl.shaderSource(vertexShader, vertexShaderScript);\n    gl.compileShader(vertexShader);\n    if(!gl.getShaderParameter(vertexShader, gl.COMPILE_STATUS)) {\n        console.log('Vertex shader failed to compile: ' + gl.getShaderInfoLog(vertexShader));\n    }\n\n    var fragmentShader = gl.createShader(gl.FRAGMENT_SHADER);\n    gl.shaderSource(fragmentShader, fragmentShaderScript);\n    gl.compileShader(fragmentShader);\n    if(!gl.getShaderParameter(fragmentShader, gl.COMPILE_STATUS)) {\n        console.log('Fragment shader failed to compile: ' + gl.getShaderInfoLog(fragmentShader));\n    }\n\n    var program = gl.createProgram();\n    gl.attachShader(program, vertexShader);\n    gl.attachShader(program, fragmentShader);\n    gl.linkProgram(program);\n    if(!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n        console.log('Program failed to compile: ' + gl.getProgramInfoLog(program));\n    }\n\n    gl.useProgram(program);\n    \n    this.shaderProgram = program;\n}\n\n/**\n * Initialize vertex buffers and attach to shader program\n */\nH264bsdCanvas.prototype.initBuffers = function() {\n    var gl = this.contextGL;\n    var program = this.shaderProgram;\n\n    var vertexPosBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertexPosBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([1, 1, -1, 1, 1, -1, -1, -1]), gl.STATIC_DRAW);\n\n    var vertexPosRef = gl.getAttribLocation(program, 'vertexPos');\n    gl.enableVertexAttribArray(vertexPosRef);\n    gl.vertexAttribPointer(vertexPosRef, 2, gl.FLOAT, false, 0, 0);\n\n    var texturePosBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, texturePosBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([1, 0, 0, 0, 1, 1, 0, 1]), gl.STATIC_DRAW);\n\n    var texturePosRef = gl.getAttribLocation(program, 'texturePos');\n    gl.enableVertexAttribArray(texturePosRef);\n    gl.vertexAttribPointer(texturePosRef, 2, gl.FLOAT, false, 0, 0);\n\n    this.texturePosBuffer = texturePosBuffer;\n}\n\n/**\n * Initialize GL textures and attach to shader program\n */\nH264bsdCanvas.prototype.initTextures = function() {\n    var gl = this.contextGL;\n    var program = this.shaderProgram;\n\n    var yTextureRef = this.initTexture();\n    var ySamplerRef = gl.getUniformLocation(program, 'ySampler');\n    gl.uniform1i(ySamplerRef, 0);\n    this.yTextureRef = yTextureRef;\n\n    var uTextureRef = this.initTexture();\n    var uSamplerRef = gl.getUniformLocation(program, 'uSampler');\n    gl.uniform1i(uSamplerRef, 1);\n    this.uTextureRef = uTextureRef;\n\n    var vTextureRef = this.initTexture();\n    var vSamplerRef = gl.getUniformLocation(program, 'vSampler');\n    gl.uniform1i(vSamplerRef, 2);\n    this.vTextureRef = vTextureRef;\n}\n\n/**\n * Create and configure a single texture\n */\nH264bsdCanvas.prototype.initTexture = function() {\n    var gl = this.contextGL;\n\n    var textureRef = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, textureRef);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n    gl.bindTexture(gl.TEXTURE_2D, null);\n\n    return textureRef;\n}\n\n/**\n * Draw picture data to the canvas.\n * If this object is using WebGL, the data must be an I420 formatted ArrayBuffer,\n * Otherwise, data must be an RGBA formatted ArrayBuffer.\n */\nH264bsdCanvas.prototype.drawFrame = function(frame) {\n    var gl = this.contextGL;\n    var { width, height, data } = frame;\n    var croppingParams = null;\n    if(gl) {\n        this.drawNextOuptutPictureGL(width, height, croppingParams, new Uint8Array(data));\n    } else {\n        this.drawNextOuptutPictureRGBA(width, height, croppingParams, new Uint8Array(data));\n    }\n}\n\n/**\n * Draw the next output picture using WebGL\n */\nH264bsdCanvas.prototype.drawNextOuptutPictureGL = function(width, height, croppingParams, data) {\n    var gl = this.contextGL;\n    var texturePosBuffer = this.texturePosBuffer;\n    var yTextureRef = this.yTextureRef;\n    var uTextureRef = this.uTextureRef;\n    var vTextureRef = this.vTextureRef;    \n\n    if(croppingParams === null) {\n        gl.viewport(0, 0, width, height);\n    } else {\n        gl.viewport(0, 0, croppingParams.width, croppingParams.height);\n\n        var tTop = croppingParams.top / height;\n        var tLeft = croppingParams.left / width;\n        var tBottom = croppingParams.height / height;\n        var tRight = croppingParams.width / width;\n        var texturePosValues = new Float32Array([tRight, tTop, tLeft, tTop, tRight, tBottom, tLeft, tBottom]);\n\n        gl.bindBuffer(gl.ARRAY_BUFFER, texturePosBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, texturePosValues, gl.DYNAMIC_DRAW);\n    }\n\n    var i420Data = data;\n\n    var yDataLength = width * height;\n    var yData = i420Data.subarray(0, yDataLength);\n    gl.activeTexture(gl.TEXTURE0);\n    gl.bindTexture(gl.TEXTURE_2D, yTextureRef);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.LUMINANCE, width, height, 0, gl.LUMINANCE, gl.UNSIGNED_BYTE, yData);\n\n    var cbDataLength = width/2 * height/2;\n    var cbData = i420Data.subarray(yDataLength, yDataLength + cbDataLength);\n    gl.activeTexture(gl.TEXTURE1);\n    gl.bindTexture(gl.TEXTURE_2D, uTextureRef);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.LUMINANCE, width/2, height/2, 0, gl.LUMINANCE, gl.UNSIGNED_BYTE, cbData);\n\n    var crDataLength = cbDataLength;\n    var crData = i420Data.subarray(yDataLength + cbDataLength, yDataLength + cbDataLength + crDataLength);\n    gl.activeTexture(gl.TEXTURE2);\n    gl.bindTexture(gl.TEXTURE_2D, vTextureRef);\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.LUMINANCE, width/2, height/2, 0, gl.LUMINANCE, gl.UNSIGNED_BYTE, crData);\n\n    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4); \n}\n\n/**\n * Draw next output picture using ARGB data on a 2d canvas.\n */\nH264bsdCanvas.prototype.drawNextOuptutPictureRGBA = function(width, height, croppingParams, data) {\n    var canvas = this.canvasElement;\n\n    var croppingParams = null;\n\n    var argbData = data;\n\n    var ctx = canvas.getContext('2d');\n    var imageData = ctx.getImageData(0, 0, width, height);\n    imageData.data.set(argbData);\n\n    if(croppingParams === null) {\n        ctx.putImageData(imageData, 0, 0);\n    } else {\n        ctx.putImageData(imageData, -croppingParams.left, -croppingParams.top, 0, 0, croppingParams.width, croppingParams.height);\n    }\n}\n","import { createWorker, calculationRate } from '../../../utils';\nimport Renderer from './renderer';\nimport workerString from './decoder.worker';\n\nexport default class VideoDecoder {\n    constructor(flv, decoder) {\n        this.flv = flv;\n        const { player, events, options, debug } = flv;\n\n        this.ready = false;\n        this.playing = false;\n        this.playIndex = 0;\n        this.videoframes = [];\n        this.timestamps = [];\n        this.videoInputLength = 0;\n        this.decoding = false;\n        this.byteSize = 0;\n        this.loaded = 0;\n        this.initLiveTimestamp = false;\n        this.decoderWorker = createWorker(workerString);\n        this.renderer = new Renderer(player.$canvas);\n\n        this.decoderRate = calculationRate(rate => {\n            flv.emit('decoderRate', rate);\n        });\n\n        this.drawRate = calculationRate(rate => {\n            flv.emit('drawRate', rate);\n        });\n\n        flv.on('destroy', () => {\n            this.videoframes = [];\n            this.timestamps = [];\n            this.decoderWorker.terminate();\n            this.stop();\n        });\n\n        events.proxy(this.decoderWorker, 'message', event => {\n            const message = event.data;\n            switch (message.type) {\n                case 'pictureReady':\n                    if (options.live && !this.playing && this.ready) return;\n                    this.byteSize += message.data.byteLength;\n                    this.videoframes.push(message);\n                    this.decoding = this.videoframes.length !== this.videoInputLength;\n                    this.loaded = this.videoframes.length / player.frameRate;\n                    flv.emit('videoLoaded', this.loaded);\n                    this.decoderRate(1);\n                    if (!this.ready && this.videoframes.length === 1) {\n                        this.ready = true;\n                        flv.emit('ready');\n                    }\n                    break;\n                default:\n                    break;\n            }\n        });\n\n        flv.on('videoData', (frame, timestamp) => {\n            this.decoding = true;\n            this.decoderWorker.postMessage({ type: 'decode', data: frame.buffer }, [frame.buffer]);\n            this.timestamps.push(timestamp);\n            this.videoInputLength += 1;\n            if (options.live && !this.initLiveTimestamp) {\n                decoder.currentTime = timestamp / 1000;\n                this.initLiveTimestamp = true;\n            }\n        });\n\n        flv.on('timeupdate', currentTime => {\n            const index = this.playIndex;\n            const timestamp = this.timestamps[index];\n            if (timestamp !== undefined && currentTime * 1000 >= timestamp) {\n                if (this.draw(index)) {\n                    const framesSize = this.getFramesSize(index);\n                    if (\n                        options.live &&\n                        framesSize >= options.freeMemory &&\n                        this.videoframes.length - 1 > index &&\n                        this.timestamps.length - 1 > index\n                    ) {\n                        this.playIndex = 0;\n                        this.videoframes.splice(0, index + 1);\n                        this.timestamps.splice(0, index + 1);\n                        decoder.currentTime = this.timestamps[0] / 1000;\n                        debug.log('Free Memory', `Size: ${framesSize / 1024 / 1024} M`, `Index: ${index}`);\n                    } else {\n                        this.playIndex += 1;\n                    }\n                } else {\n                    if (!options.live) {\n                        this.stop();\n                    }\n                }\n            }\n        });\n    }\n\n    getFramesSize(framesIndex) {\n        let framesSize = 0;\n        for (let index = 0; index < framesIndex; index++) {\n            framesSize += this.videoframes[index].data.byteLength;\n        }\n        return framesSize;\n    }\n\n    draw(index) {\n        const videoframe = this.videoframes[index];\n        if (!videoframe) return false;\n        this.renderer.drawFrame(videoframe);\n        this.drawRate(1);\n        return true;\n    }\n\n    play(startTime = 0) {\n        this.playing = true;\n        if (this.flv.options.live) {\n            this.playIndex = 0;\n            this.videoframes = [];\n            this.timestamps = [];\n            this.initLiveTimestamp = false;\n        } else {\n            this.playIndex = Math.round(startTime * this.flv.player.frameRate);\n        }\n    }\n\n    stop() {\n        this.playing = false;\n        if (this.flv.options.live) {\n            this.playIndex = 0;\n            this.videoframes = [];\n            this.timestamps = [];\n            this.initLiveTimestamp = false;\n        }\n    }\n}\n"],"names":["createWorker","workerString","Worker","URL","createObjectURL","Blob","type","getNowTime","performance","now","Date","calculationRate","callback","totalSize","lastTime","size","thisTime","diffTime","H264bsdCanvas","canvas","forceNoGL","canvasElement","initContextGL","contextGL","initProgram","initBuffers","initTextures","prototype","isWebGL","gl","validContextNames","nameIndex","length","contextName","getContext","e","getParameter","vertexShaderScript","join","fragmentShaderScript","vertexShader","createShader","VERTEX_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","console","log","getShaderInfoLog","fragmentShader","FRAGMENT_SHADER","program","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","useProgram","shaderProgram","vertexPosBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","vertexPosRef","getAttribLocation","enableVertexAttribArray","vertexAttribPointer","FLOAT","texturePosBuffer","texturePosRef","yTextureRef","initTexture","ySamplerRef","getUniformLocation","uniform1i","uTextureRef","uSamplerRef","vTextureRef","vSamplerRef","textureRef","createTexture","bindTexture","TEXTURE_2D","texParameteri","TEXTURE_MAG_FILTER","LINEAR","TEXTURE_MIN_FILTER","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","drawFrame","frame","width","height","data","croppingParams","drawNextOuptutPictureGL","Uint8Array","drawNextOuptutPictureRGBA","viewport","tTop","top","tLeft","left","tBottom","tRight","texturePosValues","DYNAMIC_DRAW","i420Data","yDataLength","yData","subarray","activeTexture","TEXTURE0","texImage2D","LUMINANCE","UNSIGNED_BYTE","cbDataLength","cbData","TEXTURE1","crDataLength","crData","TEXTURE2","drawArrays","TRIANGLE_STRIP","argbData","ctx","imageData","getImageData","set","putImageData","VideoDecoder","flv","decoder","player","events","options","debug","ready","playing","playIndex","videoframes","timestamps","videoInputLength","decoding","byteSize","loaded","initLiveTimestamp","decoderWorker","renderer","Renderer","$canvas","decoderRate","rate","emit","drawRate","on","terminate","stop","proxy","event","message","live","byteLength","push","frameRate","timestamp","postMessage","buffer","currentTime","index","undefined","draw","framesSize","getFramesSize","freeMemory","splice","framesIndex","videoframe","startTime","Math","round"],"mappings":"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"}